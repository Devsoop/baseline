{%- assign block_tall = section.blocks | where: 'type', 'card_tall' | first -%}
{%- assign block_fresh = section.blocks | where: 'type', 'card_fresh' | first -%}
{%- assign block_lab = section.blocks | where: 'type', 'card_lab' | first -%}
{%- assign block_try = section.blocks | where: 'type', 'card_try' | first -%}
{%- assign block_cold = section.blocks | where: 'type', 'card_cold' | first -%}

{%- style -%}
  #GridLayout-{{ section.id }} {
    width: 100%;
    max-width: 100%;
    box-sizing: border-box;
    background: #fff;
    padding: clamp(40px, 9vw, 180px) clamp(20px, 4vw, 80px);
  }

  #GridLayout-{{ section.id }} .grid-layout__inner {
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: stretch;
    gap: clamp(12px, 1vw, 20px);
    width: 100%;
    max-width: 1280px;
    margin: 0 auto;
  }

  /* ── Tall Card (Left) ── */
  #GridLayout-{{ section.id }} .grid-layout__tall {
    flex: 0 1 32%;
    max-width: 413px;
    width: 100%;
    position: relative;
    overflow: hidden;
    border-radius: 12px;
    background: #f6f7f6;
    aspect-ratio: 413 / 940;
  }

  #GridLayout-{{ section.id }} .grid-layout__tall-img {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 88%;
    object-fit: contain;
    object-position: center top;
    z-index: 1;
  }

  #GridLayout-{{ section.id }} .grid-layout__tall-placeholder {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 88%;
    background: linear-gradient(180deg, #3a2520 0%, #4a3028 60%, rgba(246,247,246,0) 96%, #f6f7f6 99%);
    z-index: 1;
  }

  #GridLayout-{{ section.id }} .grid-layout__tall-title {
    position: absolute;
    bottom: 30px;
    left: 30px;
    width: calc(100% - 60px);
    max-width: 326px;
    text-align: left;
    font-family: var(--font-body-family);
    font-style: italic;
    font-weight: 400;
    font-size: clamp(14px, 1.2vw, 18px);
    line-height: 1.4;
    color: #000;
    z-index: 2;
  }

  #GridLayout-{{ section.id }} .grid-layout__tall-title::first-line {
    font-weight: 700;
    font-size: 1.15em;
  }

  /* ── Grid Container (Right) ── */
  #GridLayout-{{ section.id }} .grid-layout__grid {
    flex: 1 1 66%;
    min-width: 0;
    max-width: 847px;
    display: flex;
    flex-direction: column;
    gap: clamp(12px, 1vw, 20px);
    align-self: stretch;
  }

  #GridLayout-{{ section.id }} .grid-layout__row {
    width: 100%;
    display: flex;
    flex-direction: row;
    gap: clamp(12px, 1vw, 20px);
    flex: 1 1 0;
    min-height: 0;
    flex-basis: 0;
  }

  /* ── Base Card Styles ── */
  #GridLayout-{{ section.id }} .grid-layout__card {
    position: relative;
    overflow: hidden;
    border-radius: 12px;
    min-width: 0;
    min-height: 0;
  }

  /* ── Fresh Card ── */
  #GridLayout-{{ section.id }} .grid-layout__card--fresh {
    flex: 1 1 49%;
    background: #f6f7f6;
  }

  #GridLayout-{{ section.id }} .grid-layout__card--fresh .grid-layout__card-img {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 70%;
    max-width: 290px;
    height: auto;
    max-height: 70%;
    object-fit: contain;
    z-index: 1;
  }

  #GridLayout-{{ section.id }} .grid-layout__card--fresh .grid-layout__card-placeholder {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 70%;
    max-width: 290px;
    aspect-ratio: 1;
    background: linear-gradient(180deg, #c8b89a 0%, #a89070 50%, #f6f7f6 88%);
    z-index: 1;
  }

  #GridLayout-{{ section.id }} .grid-layout__card--fresh .grid-layout__card-copy {
    position: absolute;
    top: 30px;
    left: 30px;
    width: calc(100% - 60px);
    max-width: 326px;
    text-align: left;
    font-family: var(--font-body-family);
    font-style: italic;
    font-weight: 400;
    font-size: clamp(14px, 1.2vw, 18px);
    line-height: 1.4;
    color: #000;
    z-index: 2;
  }

  #GridLayout-{{ section.id }} .grid-layout__card--fresh .grid-layout__card-copy::first-line {
    font-weight: 700;
  }

  /* ── Lab Verified Card ── */
  #GridLayout-{{ section.id }} .grid-layout__card--lab {
    flex: 1 1 49%;
    background: #9e011e;
  }

  #GridLayout-{{ section.id }} .grid-layout__card--lab .grid-layout__card-header {
    position: absolute;
    top: 40px;
    left: 40px;
    width: calc(100% - 80px);
    max-width: 334px;
    z-index: 1;
  }

  #GridLayout-{{ section.id }} .grid-layout__card--lab .grid-layout__card-title {
    width: 100%;
    font-family: var(--font-heading-family);
    font-weight: 500;
    font-size: clamp(24px, 2.2vw, 42px);
    line-height: 1.2;
    letter-spacing: 0.02em;
    text-transform: uppercase;
    color: #fff;
    margin-bottom: 20px;
  }

  #GridLayout-{{ section.id }} .grid-layout__card--lab .grid-layout__card-desc {
    width: 100%;
    font-family: var(--font-body-family);
    font-size: clamp(14px, 1.2vw, 18px);
    line-height: 1.4;
    color: #fff;
  }

  #GridLayout-{{ section.id }} .grid-layout__card--lab .grid-layout__card-btn {
    position: absolute;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    width: calc(100% - 60px);
    max-width: 307px;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 12px 40px;
    border: 1px solid #fff;
    border-radius: 100px;
    cursor: pointer;
    transition: background 0.25s, color 0.25s;
    z-index: 1;
  }

  #GridLayout-{{ section.id }} .grid-layout__card--lab .grid-layout__card-btn:hover {
    background: #fff;
  }

  #GridLayout-{{ section.id }} .grid-layout__card--lab .grid-layout__card-btn:hover a {
    color: #000;
  }

  #GridLayout-{{ section.id }} .grid-layout__card--lab .grid-layout__card-btn a {
    font-family: var(--font-heading-family);
    font-weight: 700;
    font-size: clamp(12px, 0.9vw, 16px);
    letter-spacing: 0.06em;
    text-transform: uppercase;
    color: #fff;
    text-decoration: none;
    transition: color 0.25s;
  }

  /* ── Health Card ── */
  #GridLayout-{{ section.id }} .grid-layout__card--try {
    flex: 1 1 36%;
    background: #000;
  }

  #GridLayout-{{ section.id }} .grid-layout__card--try .grid-layout__card-header {
    position: absolute;
    top: 30px;
    left: 30px;
    width: calc(100% - 60px);
    max-width: 225px;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 20px;
    z-index: 1;
  }

  #GridLayout-{{ section.id }} .grid-layout__card--try .grid-layout__card-icon {
    flex-shrink: 0;
    width: 68px;
    height: 68px;
    line-height: 0;
  }

  #GridLayout-{{ section.id }} .grid-layout__card--try .grid-layout__card-icon svg {
    width: 100%;
    height: 100%;
    display: block;
  }

  #GridLayout-{{ section.id }} .grid-layout__card--try .grid-layout__card-title {
    width: 100%;
    text-align: left;
    font-family: var(--font-heading-family);
    font-weight: 500;
    font-size: clamp(18px, 1.5vw, 24px);
    line-height: 1.2;
    letter-spacing: 0.02em;
    text-transform: uppercase;
    color: #fff;
  }

  #GridLayout-{{ section.id }} .grid-layout__card--try .grid-layout__card-btn {
    position: absolute;
    bottom: 30px;
    left: 30px;
    width: calc(100% - 60px);
    max-width: 225px;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 12px 40px;
    border: 1px solid #fff;
    border-radius: 100px;
    cursor: pointer;
    transition: background 0.25s, color 0.25s;
    z-index: 1;
  }

  #GridLayout-{{ section.id }} .grid-layout__card--try .grid-layout__card-btn:hover {
    background: #fff;
  }

  #GridLayout-{{ section.id }} .grid-layout__card--try .grid-layout__card-btn:hover a {
    color: #000;
  }

  #GridLayout-{{ section.id }} .grid-layout__card--try .grid-layout__card-btn a {
    font-family: var(--font-heading-family);
    font-weight: 700;
    font-size: clamp(12px, 0.9vw, 16px);
    letter-spacing: 0.06em;
    text-transform: uppercase;
    color: #fff;
    text-decoration: none;
    transition: color 0.25s;
  }

  /* ── Cold Extracted Card ── */
  #GridLayout-{{ section.id }} .grid-layout__card--cold {
    flex: 1 1 62%;
    background: #f6f7f6;
  }

  #GridLayout-{{ section.id }} .grid-layout__card--cold .grid-layout__card-img-wrap {
    position: absolute;
    top: 44px;
    left: 50%;
    transform: translateX(-50%);
    width: 58%;
    max-width: 305px;
    aspect-ratio: 305 / 298;
    border-radius: 50% 50% 45% 45%;
    overflow: hidden;
    z-index: 1;
    padding: 0;
  }

  #GridLayout-{{ section.id }} .grid-layout__card--cold .grid-layout__card-img-wrap img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  #GridLayout-{{ section.id }} .grid-layout__card--cold .grid-layout__card-placeholder {
    position: absolute;
    top: 44px;
    left: 50%;
    transform: translateX(-50%);
    width: 58%;
    max-width: 305px;
    aspect-ratio: 305 / 298;
    background: linear-gradient(180deg, #e8ddd0 0%, #d4c4b0 100%);
    border-radius: 50% 50% 45% 45%;
    z-index: 1;
    padding: 0;
  }

  #GridLayout-{{ section.id }} .grid-layout__card--cold .grid-layout__card-copy {
    position: absolute;
    bottom: 30px;
    left: 30px;
    width: calc(100% - 60px);
    max-width: 374px;
    text-align: left;
    font-family: var(--font-body-family);
    font-style: italic;
    font-weight: 400;
    font-size: clamp(14px, 1.2vw, 18px);
    line-height: 1.4;
    color: #000;
    z-index: 2;
  }

  #GridLayout-{{ section.id }} .grid-layout__card--cold .grid-layout__card-copy::first-line {
    font-weight: 700;
  }

  /* ── Tablet ── */
  @media (max-width: 1024px) {
    #GridLayout-{{ section.id }} {
      padding: 5vw 5%;
    }
    #GridLayout-{{ section.id }} .grid-layout__inner {
      flex-direction: column;
      height: auto;
      min-height: 0;
    }
    #GridLayout-{{ section.id }} .grid-layout__tall {
      width: 100%;
      max-width: 413px;
      height: auto;
      aspect-ratio: 413 / 500;
      margin: 0 auto;
    }
    #GridLayout-{{ section.id }} .grid-layout__grid {
      width: 100%;
      max-width: 100%;
      margin: 0 auto;
      height: auto;
    }
    #GridLayout-{{ section.id }} .grid-layout__row {
      flex-direction: column;
      flex: 0 0 auto;
      height: auto;
      min-height: 0;
    }
    #GridLayout-{{ section.id }} .grid-layout__card--fresh,
    #GridLayout-{{ section.id }} .grid-layout__card--lab,
    #GridLayout-{{ section.id }} .grid-layout__card--try,
    #GridLayout-{{ section.id }} .grid-layout__card--cold {
      width: 100%;
      flex: 0 0 auto;
      height: auto;
      min-height: 280px;
    }
  }

  /* ── Mobile ── */
  @media (max-width: 768px) {
    #GridLayout-{{ section.id }} {
      padding: 40px 20px;
    }
    #GridLayout-{{ section.id }} .grid-layout__inner {
      gap: 20px;
      flex-direction: column;
    }
    #GridLayout-{{ section.id }} .grid-layout__tall {
      max-width: 100%;
      width: 100%;
      aspect-ratio: 413 / 500;
      min-height: 320px;
    }
    #GridLayout-{{ section.id }} .grid-layout__tall-title {
      bottom: 20px;
      left: 20px;
      width: calc(100% - 40px);
      font-size: 14px;
    }
    #GridLayout-{{ section.id }} .grid-layout__grid {
      width: 100%;
      gap: 12px;
    }
    #GridLayout-{{ section.id }} .grid-layout__row {
      gap: 12px;
      flex-direction: row;
    }
    #GridLayout-{{ section.id }} .grid-layout__row:first-child {
      flex-direction: row;
    }
    #GridLayout-{{ section.id }} .grid-layout__row:last-child {
      flex-direction: column;
    }
    #GridLayout-{{ section.id }} .grid-layout__card--fresh {
      flex: 1 1 49%;
      width: auto;
      min-height: 280px;
    }
    #GridLayout-{{ section.id }} .grid-layout__card--fresh .grid-layout__card-copy {
      top: 16px;
      left: 16px;
      width: calc(100% - 32px);
      font-size: 12px;
    }
    #GridLayout-{{ section.id }} .grid-layout__card--fresh .grid-layout__card-img {
      width: 70%;
      max-width: 180px;
    }
    #GridLayout-{{ section.id }} .grid-layout__card--lab {
      flex: 1 1 49%;
      width: auto;
      min-height: 280px;
    }
    #GridLayout-{{ section.id }} .grid-layout__card--lab .grid-layout__card-header {
      top: 16px;
      left: 16px;
      width: calc(100% - 32px);
    }
    #GridLayout-{{ section.id }} .grid-layout__card--lab .grid-layout__card-title {
      font-size: 16px;
      margin-bottom: 8px;
      line-height: 1.1;
    }
    #GridLayout-{{ section.id }} .grid-layout__card--lab .grid-layout__card-desc {
      font-size: 11px;
      line-height: 1.3;
    }
    #GridLayout-{{ section.id }} .grid-layout__card--lab .grid-layout__card-btn {
      bottom: 16px;
      width: calc(100% - 32px);
      padding: 8px 16px;
    }
    #GridLayout-{{ section.id }} .grid-layout__card--lab .grid-layout__card-btn a {
      font-size: 10px;
    }
    #GridLayout-{{ section.id }} .grid-layout__card--try {
      width: 100%;
      min-height: 280px;
    }
    #GridLayout-{{ section.id }} .grid-layout__card--try .grid-layout__card-header {
      top: 20px;
      left: 20px;
      width: calc(100% - 40px);
      gap: 16px;
    }
    #GridLayout-{{ section.id }} .grid-layout__card--try .grid-layout__card-icon {
      width: 56px;
      height: 56px;
    }
    #GridLayout-{{ section.id }} .grid-layout__card--try .grid-layout__card-title {
      font-size: 16px;
    }
    #GridLayout-{{ section.id }} .grid-layout__card--try .grid-layout__card-btn {
      bottom: 20px;
      left: 20px;
      width: calc(100% - 40px);
      max-width: 100%;
      padding: 10px 24px;
    }
    #GridLayout-{{ section.id }} .grid-layout__card--cold {
      width: 100%;
      min-height: 320px;
    }
    #GridLayout-{{ section.id }} .grid-layout__card--cold .grid-layout__card-img-wrap {
      top: 30px;
      width: 65%;
      max-width: 280px;
    }
    #GridLayout-{{ section.id }} .grid-layout__card--cold .grid-layout__card-copy {
      bottom: 20px;
      left: 20px;
      width: calc(100% - 40px);
      font-size: 14px;
    }
  }
{%- endstyle -%}

<section id="GridLayout-{{ section.id }}" class="grid-layout">
  <div class="grid-layout__inner">
    <!-- Tall Card (Left) -->
    <div class="grid-layout__tall">
      {%- if block_tall != blank and block_tall.settings.image != blank -%}
        <img
          class="grid-layout__tall-img"
          src="{{ block_tall.settings.image | image_url: width: 826 }}"
          srcset="{{ block_tall.settings.image | image_url: width: 413 }} 413w, {{ block_tall.settings.image | image_url: width: 826 }} 826w"
          sizes="(max-width: 1024px) 100vw, 413px"
          alt="{{ block_tall.settings.image.alt | default: block_tall.settings.title | escape }}"
          width="413"
          height="835"
          loading="lazy"
        >
      {%- else -%}
        <div class="grid-layout__tall-placeholder" aria-hidden="true"></div>
      {%- endif -%}
      <div class="grid-layout__tall-title">
        {%- if block_tall != blank -%}{{ block_tall.settings.title | newline_to_br }}{%- else -%}Small Batch.<br>Produced in small batches{%- endif -%}
      </div>
    </div>

    <!-- Grid (Right) -->
    <div class="grid-layout__grid">
      <!-- Row 1 -->
      <div class="grid-layout__row">
        <!-- Fresh Card -->
        <div class="grid-layout__card grid-layout__card--fresh">
          {%- if block_fresh != blank and block_fresh.settings.image != blank -%}
            <img
              class="grid-layout__card-img"
              src="{{ block_fresh.settings.image | image_url: width: 670 }}"
              alt="{{ block_fresh.settings.image.alt | escape }}"
              width="335"
              height="414"
              loading="lazy"
            >
          {%- else -%}
            <div class="grid-layout__card-placeholder" aria-hidden="true"></div>
          {%- endif -%}
          <div class="grid-layout__card-copy">
            {%- if block_fresh != blank -%}{{ block_fresh.settings.copy | newline_to_br }}{%- endif -%}
            {%- if block_fresh == blank or block_fresh.settings.copy == blank -%}Fresh.<br>Always from the most recent harvest season{%- endif -%}
          </div>
        </div>

        <!-- Lab Verified Card -->
        <div
          class="grid-layout__card grid-layout__card--lab"
          {% if block_lab != blank and block_lab.settings.background_color != blank %}style="background-color: {{ block_lab.settings.background_color }};"{% endif %}
        >
          <div class="grid-layout__card-header">
            <div class="grid-layout__card-title">{%- if block_lab != blank -%}{{ block_lab.settings.title }}{%- else -%}LAB VERIFIED{%- endif -%}</div>
            <div class="grid-layout__card-desc">{%- if block_lab != blank -%}{{ block_lab.settings.description }}{%- else -%}Our oil meets and exceeds International Olive Council standards for Extra Virgin classification.{%- endif -%}</div>
          </div>
          <div class="grid-layout__card-btn">
            <a href="{% if block_lab != blank %}{{ block_lab.settings.button_url | default: '#' }}{% else %}#{% endif %}">{%- if block_lab != blank -%}{{ block_lab.settings.button_text | default: 'SEE EXAMPLE LAB REPORT' }}{%- else -%}SEE EXAMPLE LAB REPORT{%- endif -%}</a>
          </div>
        </div>
      </div>

      <!-- Row 2 -->
      <div class="grid-layout__row">
        <!-- Health Card -->
        <div
          class="grid-layout__card grid-layout__card--try"
          {% if block_try != blank and block_try.settings.background_color != blank %}style="background-color: {{ block_try.settings.background_color }};"{% endif %}
        >
          <div class="grid-layout__card-header">
            <div class="grid-layout__card-icon" aria-hidden="true">
              <svg width="68" height="68" viewBox="0 0 68 68" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect width="68" height="68" rx="34" fill="#ECECF0"/>
                <path d="M48.5652 39.3586C48.5652 47.5229 41.9468 54.1413 33.7826 54.1413C25.6184 54.1413 19 47.5229 19 39.3586C19 28.6413 33.7826 13.8586 33.7826 13.8586C33.7826 13.8586 48.5652 28.2717 48.5652 39.3586Z" fill="black"/>
              </svg>
            </div>
            <div class="grid-layout__card-title">{%- if block_try != blank -%}{{ block_try.settings.title }}{%- else -%}HEALTH IN EVERY DROP{%- endif -%}</div>
          </div>
          <div class="grid-layout__card-btn">
            <a href="{% if block_try != blank %}{{ block_try.settings.button_url | default: '#' }}{% else %}#{% endif %}">{%- if block_try != blank -%}{{ block_try.settings.button_text | default: 'TRY BASELINE' }}{%- else -%}TRY BASELINE{%- endif -%}</a>
          </div>
        </div>

        <!-- Cold Extracted Card -->
        <div class="grid-layout__card grid-layout__card--cold">
          {%- if block_cold != blank and block_cold.settings.image != blank -%}
            <div class="grid-layout__card-img-wrap">
              <img
                src="{{ block_cold.settings.image | image_url: width: 610 }}"
                alt="{{ block_cold.settings.image.alt | escape }}"
                width="305"
                height="298"
                loading="lazy"
              >
            </div>
          {%- else -%}
            <div class="grid-layout__card-placeholder" aria-hidden="true"></div>
          {%- endif -%}
          <div class="grid-layout__card-copy">
            {%- if block_cold != blank -%}{{ block_cold.settings.copy | newline_to_br }}{%- endif -%}
            {%- if block_cold == blank or block_cold.settings.copy == blank -%}Cold Extracted.<br>Cold extraction to preserve polyphenols{%- endif -%}
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Grid layout (cards)",
  "tag": "section",
  "class": "section-grid-layout",
  "settings": [],
  "blocks": [
    {
      "type": "card_tall",
      "name": "Tall card",
      "limit": 1,
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "textarea",
          "id": "title",
          "label": "Title",
          "default": "Small Batch.\nProduced in small batches"
        }
      ]
    },
    {
      "type": "card_fresh",
      "name": "Fresh card",
      "limit": 1,
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "textarea",
          "id": "copy",
          "label": "Copy",
          "default": "Fresh.\nAlways from the most recent harvest season"
        }
      ]
    },
    {
      "type": "card_lab",
      "name": "Lab Verified card",
      "limit": 1,
      "settings": [
        {
          "type": "color",
          "id": "background_color",
          "label": "Background color",
          "default": "#9e011e"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "LAB VERIFIED"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Description",
          "default": "Our oil meets and exceeds International Olive Council standards for Extra Virgin classification."
        },
        {
          "type": "text",
          "id": "button_text",
          "label": "Button text",
          "default": "SEE EXAMPLE LAB REPORT"
        },
        {
          "type": "url",
          "id": "button_url",
          "label": "Button URL"
        }
      ]
    },
    {
      "type": "card_try",
      "name": "Health card",
      "limit": 1,
      "settings": [
        {
          "type": "color",
          "id": "background_color",
          "label": "Background color",
          "default": "#000000"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "HEALTH IN EVERY DROP"
        },
        {
          "type": "text",
          "id": "button_text",
          "label": "Button text",
          "default": "TRY BASELINE"
        },
        {
          "type": "url",
          "id": "button_url",
          "label": "Button URL"
        }
      ]
    },
    {
      "type": "card_cold",
      "name": "Cold Extracted card",
      "limit": 1,
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "textarea",
          "id": "copy",
          "label": "Copy",
          "default": "Cold Extracted.\nCold extraction to preserve polyphenols"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Grid layout (cards)",
      "blocks": [
        { "type": "card_tall" },
        { "type": "card_fresh" },
        { "type": "card_lab" },
        { "type": "card_try" },
        { "type": "card_cold" }
      ]
    }
  ]
}
{% endschema %}
