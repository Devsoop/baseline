{% schema %}
{
  "name": "Product Comparison Table",
  "settings": [
    {
      "type": "image_picker",
      "id": "brand_logo",
      "label": "Brand Logo Image",
      "info": "Upload your brand logo (e.g., baseline logo)"
    },
    {
      "type": "text",
      "id": "competitor_name",
      "label": "Competitor Name",
      "default": "REGULAR OIL"
    },
    {
      "type": "color",
      "id": "bg_color",
      "label": "Background Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "accent_color",
      "label": "Accent/Dot Color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "content_width",
      "min": 600,
      "max": 1400,
      "step": 50,
      "unit": "px",
      "label": "Content Width",
      "default": 1100
    },
    {
      "type": "range",
      "id": "logo_width",
      "min": 80,
      "max": 250,
      "step": 10,
      "unit": "px",
      "label": "Logo Width",
      "default": 150
    }
  ],
  "blocks": [
    {
      "type": "comparison_row",
      "name": "Comparison Row",
      "settings": [
        {
          "type": "text",
          "id": "category",
          "label": "Category Name",
          "default": "POLYPHENOLS"
        },
        {
          "type": "text",
          "id": "brand_value",
          "label": "Your Brand Value",
          "default": "500+ mg/kg"
        },
        {
          "type": "text",
          "id": "competitor_value",
          "label": "Competitor Value",
          "default": "50 mg/kg"
        },
        {
          "type": "checkbox",
          "id": "brand_selected",
          "label": "Highlight Your Brand (fills the dot)",
          "default": true
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Product Comparison"
    }
  ]
}
{% endschema %}

<style>
.comparison-section {
  background-color: {{ section.settings.bg_color }};
  color: {{ section.settings.text_color }};
  padding: clamp(40px, 8vw, 80px) clamp(10px, 2vw, 20px);
  width: 100%;
}

.comparison-container {
  max-width: min({{ section.settings.content_width }}px, 95%);
  margin: 0 auto;
}

/* HEADER â€” SAME GRID AS ROWS */
.comparison-header {
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  align-items: center;
  gap: clamp(15px, 3vw, 40px);
  margin-bottom: clamp(25px, 4vw, 50px);
  padding: 0 clamp(5px, 1.5vw, 20px);
}

.brand-logo {
  display: flex;
  justify-content: center;
}

.brand-logo-img {
  width: clamp(80px, 15vw, {{ section.settings.logo_width }}px);
  height: auto;
  object-fit: contain;
}

.competitor-name {
  text-align: center;
  font-size: 25px;
  line-height: 140%;
  font-weight: 500;
  text-decoration: line-through;
  opacity: 0.6;
}

.comparison-table {
  display: flex;
  flex-direction: column;
}

.comparison-row {
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  align-items: center;
  padding: clamp(18px, 3vw, 32px) clamp(5px, 1.5vw, 20px);
  border-bottom: 3px solid rgba(255,255,255,0.08);
  gap: clamp(15px, 5vw, 60px);
}

/* VALUE CELLS PERFECTLY CENTERED */
.value-cell {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  gap: 10px;
  font-size: 16px;
  opacity: 0.6;
}

.category-cell {
  text-align: center;
  font-size: 20px;
  font-weight: 500;
  padding: 0 10px;
}

.dot-indicator {
  width: 14px;
  height: 14px;
}

/* MOBILE */
@media screen and (max-width: 550px){
  .competitor-name { font-size: 12px; }
  .category-cell { font-size: 12px; }
  .value-cell { font-size: 12px; }
}
</style>

<div class="comparison-section">
  <div class="comparison-container">

    <!-- HEADER -->
    <div class="comparison-header">

      <!-- BRAND -->
      <div class="brand-logo">
        {% if section.settings.brand_logo %}
          <img src="{{ section.settings.brand_logo | image_url: width: 400 }}"
               alt="Brand Logo"
               class="brand-logo-img"
               loading="lazy">
        {% else %}
          <div style="opacity:.5;">Upload your logo</div>
        {% endif %}
      </div>

      <!-- EMPTY CENTER COLUMN FOR ALIGNMENT -->
      <div></div>

      <!-- COMPETITOR -->
      <div class="competitor-name">
        {{ section.settings.competitor_name }}
      </div>

    </div>

    <!-- ROWS -->
    <div class="comparison-table">
      {% for block in section.blocks %}
      <div class="comparison-row" {{ block.shopify_attributes }}>

        <!-- BRAND VALUE -->
        <div class="value-cell">
          <svg class="dot-indicator" viewBox="0 0 20 20">
            {% if block.settings.brand_selected %}
              <circle cx="10" cy="10" r="8" fill="{{ section.settings.accent_color }}" stroke="{{ section.settings.accent_color }}" stroke-width="2"/>
            {% else %}
              <circle cx="10" cy="10" r="8" fill="none" stroke="{{ section.settings.accent_color }}" stroke-width="2"/>
            {% endif %}
          </svg>
          <span>{{ block.settings.brand_value }}</span>
        </div>

        <!-- CATEGORY -->
        <div class="category-cell">
          {{ block.settings.category }}
        </div>

        <!-- COMPETITOR VALUE -->
        <div class="value-cell">
          <svg class="dot-indicator" viewBox="0 0 20 20">
            {% unless block.settings.brand_selected %}
              <circle cx="10" cy="10" r="8" fill="{{ section.settings.accent_color }}" stroke="{{ section.settings.accent_color }}" stroke-width="2"/>
            {% else %}
              <circle cx="10" cy="10" r="8" fill="none" stroke="{{ section.settings.accent_color }}" stroke-width="2"/>
            {% endunless %}
          </svg>
          <span>{{ block.settings.competitor_value }}</span>
        </div>

      </div>
      {% endfor %}
    </div>

  </div>
</div>
